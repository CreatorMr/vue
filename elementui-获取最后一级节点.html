<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <link rel="stylesheet" href="">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <!-- 引入样式 -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <!-- 引入组件库 -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
</head>

<body>
    <div id="app">
        {{ message }}
    </div>
    <div>
        <button type="" id="btn">test</button>
    </div>
    <script type="text/javascript" charset="utf-8">
        Vue.component("hello", {
            props: ['data'],
            methods: {
                consoleMsg: throttle((item) => {
                    console.log(item.text)
                }, 2000)
            },
            template: '<button v-on:click="consoleMsg(data)">You clicked me {{ data.content }} </button>'
        })


        Vue.component("hhh", {

            data() {
                return {
                    checkedKeys: [],
                    props: {
                        label: 'name',
                        children: 'zones',
                        isLeaf: 'leaf'
                    },
                    data: [{
                        id: 1,
                        label: '一级 1',
                        children: [{
                            id: 4,
                            label: '二级 1-1',
                            children: [{
                                id: 9,
                                label: '三级 1-1-1'
                            }, {
                                id: 10,
                                label: '三级 1-1-2'
                            }]
                        }]
                    }, {
                        id: 2,
                        label: '一级 2',
                        children: [{
                            id: 5,
                            label: '二级 2-1'
                        }, {
                            id: 6,
                            label: '二级 2-2'
                        }]
                    }, {
                        id: 3,
                        label: '一级 3',
                        children: [{
                            id: 7,
                            label: '二级 3-1'
                        }, {
                            id: 8,
                            label: '二级 3-2'
                        }]
                    }],
                    defaultProps: {
                        children: 'children',
                        label: 'label'
                    }
                };
            },
            methods: {
                getCheckedNodes() {
                    console.log(this.$refs.tree.getCheckedNodes());
                },
                getCheckedKeys() {
                    console.log(this.$refs['res-tree'].getCheckedKeys(true));
                    console.log(this.$refs['testTree'].getCheckedKeys(true));
                },
                setCheckedNodes() {
                    this.$refs.tree.setCheckedNodes([{
                        id: 5,
                        label: '二级 2-1'
                    }, {
                        id: 9,
                        label: '三级 1-1-1'
                    }]);
                },
                setCheckedKeys() {
                    this.$refs.tree.setCheckedKeys([3]);
                },
                resetChecked() {
                    this.$refs.tree.setCheckedKeys([]);
                },
                loadNode(node, resolve) {

                    if (this.$refs.testTree != undefined) this.checkedKeys = this.$refs.testTree.getCheckedKeys();
                    if (node.level === 0) {
                        return resolve([{ name: 'region' }]);
                    }
                    if (node.level > 1) return resolve([]);

                    setTimeout(() => {
                        const data = [{
                            name: 'leaf',
                            leaf: true
                        }, {
                            name: 'zone'
                        }];

                        resolve(data);
                        if (this.checkedKeys.length) {
                            if (this.$refs.testTree != undefined) this.$refs.testTree.setCheckedKeys(this.checkedKeys);

                        }
                    }, 500);

                }
            },
            template: `<div>
            <el-tree
                      :data="data"
                      show-checkbox
                      default-expand-all
                      node-key="id"
                      ref="res-tree"
                      highlight-current
                      :props="defaultProps">
                    </el-tree>

                    <div class="buttons">
                      <el-button @click="getCheckedNodes">通过 node 获取</el-button>
                      <el-button @click="getCheckedKeys">通过 key 获取</el-button>
                      <el-button @click="setCheckedNodes">通过 node 设置</el-button>
                      <el-button @click="setCheckedKeys">通过 key 设置</el-button>
                      <el-button @click="resetChecked">清空</el-button>
                    </div>
                    <el-tree
                    :props="props"
                    :load="loadNode"
                    lazy
                    ref="testTree"
                    show-checkbox>
                    </el-tree>
        </div>`,
        })

        var app = new Vue({
            el: '#app',
            data: {
                message: 'Hello Vue!',
                data: [{
                    text: "文本",
                    content: "内容"
                }]
            },
            template: `
            <div>
                <div v-for="item in data">
                    <hello :data="item" />
                    <hhh />
                </div>
            </div>
        `,

        })

        var btn = document.getElementById("btn");
        window.onload = function () {
            // 初始化内容 
            btn.addEventListener('click', () => {
                console.log("点击了按钮")
                b()
            })
        }

        function b() {
            console.log("打印了b")
            c()

        }

        function c() {
            console.log("打印了c")
            // throttle(d,3000)
            // let t = throttle(function(){
            //     console.log("节流了")
            // },3000)
            let t = _debounce(() => {
                console.log("防抖了")
            }, 3000)
            t()

        }

        function d() {
            console.log("打印了d")
        }

        function throttle(func, gapTime) {
            let endTime = null;
            return function () {
                let currentTime = new Date().getTime();
                if (!endTime || currentTime - endTime > gapTime) {
                    func.apply(this, arguments);
                    endTime = currentTime
                }
            }
        }

        function _debounce(func, wait) {
            let timer = null
            return function () {
                clearTimeout(timer)
                timer = setTimeout(() => {
                    func.apply(this, arguments)
                }, wait)
            }
        }
    </script>
</body>

</html>
